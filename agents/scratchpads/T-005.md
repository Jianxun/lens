# T-005 â€” Ingestion pipeline
## Context
- Ingest JSONL conversations into Postgres.
- Deterministic idx ordering; filter roles to user/assistant; retain raw; truncate long messages with warnings.
- Log ingest_runs with stats.

## Scope / Allowed files
- `backend/ingest/` (new)
- `scripts/` (helpers)
- `README.md` (ingest usage)

## Steps
- Parse JSONL; traverse mapping with deterministic order to assign idx.
- Convert epoch floats to timestamptz (UTC).
- Truncate `content_text` over limit; record truncations in stats.
- Insert conversations, messages, message_embeddings (later when embeddings added) maybe deferred; for now messages.
- Insert ingest_runs row with counts/errors; fail-fast on malformed JSON file.

## DoD
- Ingest sample JSONL completes; ingest_runs status=succeeded with counts/truncations.
- Spot-check messages persisted with idx and timestamps.

